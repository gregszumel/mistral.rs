<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `mistralrs_core` crate."><title>mistralrs_core - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-081576b923113409.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="mistralrs_core" data-themes="" data-resource-suffix="" data-rustdoc-version="1.79.0 (129f3b996 2024-06-10)" data-channel="1.79.0" data-search-js="search-bf21c90c8c1d92b1.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-e32f0c247825364d.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-09095024cf37855e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../mistralrs_core/index.html">mistralrs_core</a><span class="version">0.1.20</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#statics">Statics</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../mistralrs_core/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Type ‘S’ or ‘/’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings">Settings</a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">mistralrs_core</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/mistralrs_core/lib.rs.html#1-419">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="layers/index.html" title="mod mistralrs_core::layers">layers</a></div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ChatCompletionChunkResponse.html" title="struct mistralrs_core::ChatCompletionChunkResponse">ChatCompletionChunkResponse</a></div><div class="desc docblock-short">Chat completion streaming request chunk.</div></li><li><div class="item-name"><a class="struct" href="struct.ChatCompletionResponse.html" title="struct mistralrs_core::ChatCompletionResponse">ChatCompletionResponse</a></div><div class="desc docblock-short">An OpenAI compatible chat completion response.</div></li><li><div class="item-name"><a class="struct" href="struct.ChatTemplate.html" title="struct mistralrs_core::ChatTemplate">ChatTemplate</a></div><div class="desc docblock-short">Template for chat models including bos/eos/unk as well as the chat template.</div></li><li><div class="item-name"><a class="struct" href="struct.Choice.html" title="struct mistralrs_core::Choice">Choice</a></div><div class="desc docblock-short">Chat completion choice.</div></li><li><div class="item-name"><a class="struct" href="struct.ChunkChoice.html" title="struct mistralrs_core::ChunkChoice">ChunkChoice</a></div><div class="desc docblock-short">Completion streaming chunk choice.</div></li><li><div class="item-name"><a class="struct" href="struct.CompletionChoice.html" title="struct mistralrs_core::CompletionChoice">CompletionChoice</a></div><div class="desc docblock-short">Completion request choice.</div></li><li><div class="item-name"><a class="struct" href="struct.CompletionResponse.html" title="struct mistralrs_core::CompletionResponse">CompletionResponse</a></div><div class="desc docblock-short">An OpenAI compatible completion response.</div></li><li><div class="item-name"><a class="struct" href="struct.Delta.html" title="struct mistralrs_core::Delta">Delta</a></div><div class="desc docblock-short">Delta in content for streaming response.</div></li><li><div class="item-name"><a class="struct" href="struct.DeviceMapMetadata.html" title="struct mistralrs_core::DeviceMapMetadata">DeviceMapMetadata</a></div><div class="desc docblock-short">Metadata to initialize the device mapper.</div></li><li><div class="item-name"><a class="struct" href="struct.GGMLLoader.html" title="struct mistralrs_core::GGMLLoader">GGMLLoader</a></div><div class="desc docblock-short">A loader for a GGML model.</div></li><li><div class="item-name"><a class="struct" href="struct.GGMLLoaderBuilder.html" title="struct mistralrs_core::GGMLLoaderBuilder">GGMLLoaderBuilder</a></div><div class="desc docblock-short">A builder for a GGML loader.</div></li><li><div class="item-name"><a class="struct" href="struct.GGMLSpecificConfig.html" title="struct mistralrs_core::GGMLSpecificConfig">GGMLSpecificConfig</a></div><div class="desc docblock-short">Config for a GGML loader.</div></li><li><div class="item-name"><a class="struct" href="struct.GGUFLoader.html" title="struct mistralrs_core::GGUFLoader">GGUFLoader</a></div><div class="desc docblock-short">Loader for a GGUF model.</div></li><li><div class="item-name"><a class="struct" href="struct.GGUFLoaderBuilder.html" title="struct mistralrs_core::GGUFLoaderBuilder">GGUFLoaderBuilder</a></div><div class="desc docblock-short">A builder for a GGUF loader.</div></li><li><div class="item-name"><a class="struct" href="struct.GGUFSpecificConfig.html" title="struct mistralrs_core::GGUFSpecificConfig">GGUFSpecificConfig</a></div><div class="desc docblock-short">A config for a GGUF loader.</div></li><li><div class="item-name"><a class="struct" href="struct.GemmaLoader.html" title="struct mistralrs_core::GemmaLoader">GemmaLoader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.NormalLoader.html"><code>NormalLoader</code></a> for a Gemma model.</div></li><li><div class="item-name"><a class="struct" href="struct.Idefics2Loader.html" title="struct mistralrs_core::Idefics2Loader">Idefics2Loader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.VisionLoader.html"><code>VisionLoader</code></a> for an Idefics 2 Vision model.</div></li><li><div class="item-name"><a class="struct" href="struct.LayerDeviceMapper.html" title="struct mistralrs_core::LayerDeviceMapper">LayerDeviceMapper</a></div><div class="desc docblock-short">A device mapper which does device mapping per hidden layer.</div></li><li><div class="item-name"><a class="struct" href="struct.LlamaLoader.html" title="struct mistralrs_core::LlamaLoader">LlamaLoader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.NormalLoader.html"><code>NormalLoader</code></a> for a Llama model.</div></li><li><div class="item-name"><a class="struct" href="struct.LoaderBuilder.html" title="struct mistralrs_core::LoaderBuilder">LoaderBuilder</a></div><div class="desc docblock-short">A builder for a loader using the selected model.</div></li><li><div class="item-name"><a class="struct" href="struct.LocalModelPaths.html" title="struct mistralrs_core::LocalModelPaths">LocalModelPaths</a></div><div class="desc docblock-short">All local paths and metadata necessary to load a model.</div></li><li><div class="item-name"><a class="struct" href="struct.Logprobs.html" title="struct mistralrs_core::Logprobs">Logprobs</a></div><div class="desc docblock-short">Logprobs per token.</div></li><li><div class="item-name"><a class="struct" href="struct.MistralLoader.html" title="struct mistralrs_core::MistralLoader">MistralLoader</a></div></li><li><div class="item-name"><a class="struct" href="struct.MistralRs.html" title="struct mistralrs_core::MistralRs">MistralRs</a></div><div class="desc docblock-short">The MistralRs struct handles sending requests to the engine.
It is the core multi-threaded component of mistral.rs, and uses <code>mspc</code>
<code>Sender</code> and <code>Receiver</code> primitives to send and receive requests to the
engine.</div></li><li><div class="item-name"><a class="struct" href="struct.MistralRsBuilder.html" title="struct mistralrs_core::MistralRsBuilder">MistralRsBuilder</a></div><div class="desc docblock-short">The MistralRsBuilder takes the pipeline and a scheduler method and constructs
an Engine and a MistralRs instance. The Engine runs on a separate thread, and the MistralRs
instance stays on the calling thread.</div></li><li><div class="item-name"><a class="struct" href="struct.MixtralLoader.html" title="struct mistralrs_core::MixtralLoader">MixtralLoader</a></div></li><li><div class="item-name"><a class="struct" href="struct.NormalLoader.html" title="struct mistralrs_core::NormalLoader">NormalLoader</a></div><div class="desc docblock-short">A loader for a “normal” (non-quantized) model.</div></li><li><div class="item-name"><a class="struct" href="struct.NormalLoaderBuilder.html" title="struct mistralrs_core::NormalLoaderBuilder">NormalLoaderBuilder</a></div><div class="desc docblock-short">A builder for a loader for a “normal” (non-quantized) model.</div></li><li><div class="item-name"><a class="struct" href="struct.NormalRequest.html" title="struct mistralrs_core::NormalRequest">NormalRequest</a></div><div class="desc docblock-short">A normal request request to the <code>MistralRs</code></div></li><li><div class="item-name"><a class="struct" href="struct.NormalSpecificConfig.html" title="struct mistralrs_core::NormalSpecificConfig">NormalSpecificConfig</a></div><div class="desc docblock-short">Config specific to loading a normal model.</div></li><li><div class="item-name"><a class="struct" href="struct.Ordering.html" title="struct mistralrs_core::Ordering">Ordering</a></div><div class="desc docblock-short">Adapter model ordering information.</div></li><li><div class="item-name"><a class="struct" href="struct.Phi2Loader.html" title="struct mistralrs_core::Phi2Loader">Phi2Loader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.NormalLoader.html"><code>NormalLoader</code></a> for a Phi 2 model.</div></li><li><div class="item-name"><a class="struct" href="struct.Phi3Loader.html" title="struct mistralrs_core::Phi3Loader">Phi3Loader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.NormalLoader.html"><code>NormalLoader</code></a> for a Phi 3 model.</div></li><li><div class="item-name"><a class="struct" href="struct.Phi3VLoader.html" title="struct mistralrs_core::Phi3VLoader">Phi3VLoader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.VisionLoader.html"><code>VisionLoader</code></a> for a Phi 3 Vision model.</div></li><li><div class="item-name"><a class="struct" href="struct.Qwen2Loader.html" title="struct mistralrs_core::Qwen2Loader">Qwen2Loader</a></div><div class="desc docblock-short"><a href="https://ericlbuehler.github.io/mistral.rs/mistralrs/struct.NormalLoader.html"><code>NormalLoader</code></a> for a Qwen 2 model.</div></li><li><div class="item-name"><a class="struct" href="struct.ResponseLogprob.html" title="struct mistralrs_core::ResponseLogprob">ResponseLogprob</a></div><div class="desc docblock-short">A logprob with the top logprobs for this token.</div></li><li><div class="item-name"><a class="struct" href="struct.ResponseMessage.html" title="struct mistralrs_core::ResponseMessage">ResponseMessage</a></div><div class="desc docblock-short">Chat completion response message.</div></li><li><div class="item-name"><a class="struct" href="struct.SamplingParams.html" title="struct mistralrs_core::SamplingParams">SamplingParams</a></div><div class="desc docblock-short">Sampling params are used to control sampling.</div></li><li><div class="item-name"><a class="struct" href="struct.SpeculativeConfig.html" title="struct mistralrs_core::SpeculativeConfig">SpeculativeConfig</a></div><div class="desc docblock-short">Metadata for a speculative pipeline</div></li><li><div class="item-name"><a class="struct" href="struct.SpeculativeLoader.html" title="struct mistralrs_core::SpeculativeLoader">SpeculativeLoader</a></div><div class="desc docblock-short">A loader for a speculative pipeline using 2 <a href="trait.Loader.html" title="trait mistralrs_core::Loader"><code>Loader</code></a>s.</div></li><li><div class="item-name"><a class="struct" href="struct.SpeculativePipeline.html" title="struct mistralrs_core::SpeculativePipeline">SpeculativePipeline</a></div><div class="desc docblock-short">Speculative decoding pipeline: <a href="https://arxiv.org/pdf/2211.17192">https://arxiv.org/pdf/2211.17192</a></div></li><li><div class="item-name"><a class="struct" href="struct.TopLogprob.html" title="struct mistralrs_core::TopLogprob">TopLogprob</a></div><div class="desc docblock-short">Top-n logprobs element</div></li><li><div class="item-name"><a class="struct" href="struct.Usage.html" title="struct mistralrs_core::Usage">Usage</a></div><div class="desc docblock-short">OpenAI compatible (superset) usage during a request.</div></li><li><div class="item-name"><a class="struct" href="struct.VisionLoader.html" title="struct mistralrs_core::VisionLoader">VisionLoader</a></div><div class="desc docblock-short">A loader for a vision (non-quantized) model.</div></li><li><div class="item-name"><a class="struct" href="struct.VisionLoaderBuilder.html" title="struct mistralrs_core::VisionLoaderBuilder">VisionLoaderBuilder</a></div><div class="desc docblock-short">A builder for a loader for a vision (non-quantized) model.</div></li><li><div class="item-name"><a class="struct" href="struct.VisionSpecificConfig.html" title="struct mistralrs_core::VisionSpecificConfig">VisionSpecificConfig</a></div><div class="desc docblock-short">Config specific to loading a vision model.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Constraint.html" title="enum mistralrs_core::Constraint">Constraint</a></div><div class="desc docblock-short">Control the constraint with Regex or Yacc.</div></li><li><div class="item-name"><a class="enum" href="enum.GGUFArchitecture.html" title="enum mistralrs_core::GGUFArchitecture">GGUFArchitecture</a></div></li><li><div class="item-name"><a class="enum" href="enum.MistralRsError.html" title="enum mistralrs_core::MistralRsError">MistralRsError</a></div></li><li><div class="item-name"><a class="enum" href="enum.ModelDType.html" title="enum mistralrs_core::ModelDType">ModelDType</a></div><div class="desc docblock-short">DType for the model.</div></li><li><div class="item-name"><a class="enum" href="enum.ModelKind.html" title="enum mistralrs_core::ModelKind">ModelKind</a></div><div class="desc docblock-short">The kind of model to build.</div></li><li><div class="item-name"><a class="enum" href="enum.ModelSelected.html" title="enum mistralrs_core::ModelSelected">ModelSelected</a></div></li><li><div class="item-name"><a class="enum" href="enum.NormalLoaderType.html" title="enum mistralrs_core::NormalLoaderType">NormalLoaderType</a></div><div class="desc docblock-short">The architecture to load the normal model as.</div></li><li><div class="item-name"><a class="enum" href="enum.Request.html" title="enum mistralrs_core::Request">Request</a></div><div class="desc docblock-short">A request to the Engine, encapsulating the various parameters as well as
the <code>mspc</code> response <code>Sender</code> used to return the <a href="enum.Response.html" title="enum mistralrs_core::Response"><code>Response</code></a>.</div></li><li><div class="item-name"><a class="enum" href="enum.RequestMessage.html" title="enum mistralrs_core::RequestMessage">RequestMessage</a></div><div class="desc docblock-short">Message or messages for a <a href="enum.Request.html" title="enum mistralrs_core::Request"><code>Request</code></a>.</div></li><li><div class="item-name"><a class="enum" href="enum.Response.html" title="enum mistralrs_core::Response">Response</a></div><div class="desc docblock-short">The response enum contains 3 types of variants:</div></li><li><div class="item-name"><a class="enum" href="enum.SchedulerMethod.html" title="enum mistralrs_core::SchedulerMethod">SchedulerMethod</a></div><div class="desc docblock-short">The scheduler method controld how sequences are scheduled during each
step of the engine. For each scheduling step, the scheduler method is used if there
are not only running, only waiting sequences, or none. If is it used, then it
is used to allow waiting sequences to run.</div></li><li><div class="item-name"><a class="enum" href="enum.StopTokens.html" title="enum mistralrs_core::StopTokens">StopTokens</a></div><div class="desc docblock-short">Stop sequences or ids.</div></li><li><div class="item-name"><a class="enum" href="enum.TokenSource.html" title="enum mistralrs_core::TokenSource">TokenSource</a></div><div class="desc docblock-short">The source of the HF token.</div></li><li><div class="item-name"><a class="enum" href="enum.VisionLoaderType.html" title="enum mistralrs_core::VisionLoaderType">VisionLoaderType</a></div><div class="desc docblock-short">The architecture to load the vision model as.</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.SYSTEM_FINGERPRINT.html" title="constant mistralrs_core::SYSTEM_FINGERPRINT">SYSTEM_FINGERPRINT</a></div></li></ul><h2 id="statics" class="section-header">Statics<a href="#statics" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="static" href="static.TERMINATE_ALL_NEXT_STEP.html" title="static mistralrs_core::TERMINATE_ALL_NEXT_STEP">TERMINATE_ALL_NEXT_STEP</a></div><div class="desc docblock-short">Terminate all sequences on the next scheduling step. Be sure to reset this.</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Loader.html" title="trait mistralrs_core::Loader">Loader</a></div><div class="desc docblock-short">The <code>Loader</code> trait abstracts the loading process. The primary entrypoint is the
<code>load_model</code> method.</div></li><li><div class="item-name"><a class="trait" href="trait.ModelPaths.html" title="trait mistralrs_core::ModelPaths">ModelPaths</a></div><div class="desc docblock-short"><code>ModelPaths</code> abstracts the mechanism to get all necessary files for running a model. For
example <code>LocalModelPaths</code> implements <code>ModelPaths</code> when all files are in the local file system.</div></li><li><div class="item-name"><a class="trait" href="trait.Pipeline.html" title="trait mistralrs_core::Pipeline">Pipeline</a></div></li><li><div class="item-name"><a class="trait" href="trait.TryIntoDType.html" title="trait mistralrs_core::TryIntoDType">TryIntoDType</a></div><div class="desc docblock-short">Type which can be converted to a DType</div></li><li><div class="item-name"><a class="trait" href="trait.VisionModelLoader.html" title="trait mistralrs_core::VisionModelLoader">VisionModelLoader</a></div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.get_model_dtype.html" title="fn mistralrs_core::get_model_dtype">get_model_dtype</a></div></li><li><div class="item-name"><a class="fn" href="fn.get_tgt_non_granular_index.html" title="fn mistralrs_core::get_tgt_non_granular_index">get_tgt_non_granular_index</a></div></li><li><div class="item-name"><a class="fn" href="fn.get_toml_selected_model_dtype.html" title="fn mistralrs_core::get_toml_selected_model_dtype">get_toml_selected_model_dtype</a></div></li><li><div class="item-name"><a class="fn" href="fn.initialize_logging.html" title="fn mistralrs_core::initialize_logging">initialize_logging</a></div><div class="desc docblock-short">This should be called to initialize the debug flag and logging.
This should not be called in mistralrs-core code due to Rust usage.</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.MessageContent.html" title="type mistralrs_core::MessageContent">MessageContent</a></div></li></ul></section></div></main></body></html>